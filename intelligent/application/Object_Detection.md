# Object Detection

[TOC]

## 方法

**滑动窗口方法**

其中分类器在整个图像[10]上均匀间隔的位置运行. 

**R-CNN**

区域建议方法, 首先在图像中生成潜在的边界框, 然后在这些提议的框上运行一个分类器. 分类后, 通过后处理对边界框进行细化, 消除重复检测, 并根据场景[13]中的其他对象对边界框进行重核. 

**YOLO**

- 改进: YOLO将物体检测作为回归问题,end-to-end网络,训练和检测均是在一个单独网络中进行,为提高物体定位精准性和召回率, YOLO作者提出了YOLO9000, 提高训练图像的分辨率, 引入了faster rcnn中anchor box的思想, 对各网络结构及各层的设计进行了改进, 输出层使用卷积层替代YOLO的全连接层, 联合使用coco物体检测标注数据和imagenet物体分类标注数据训练物体检测模型. 相比YOLO, YOLO9000在识别种类、精度、速度、和定位准确性等方面都有大大提升. (yolo9000详解有空给出)
- 优缺点
  - 优点: 快. YOLO将物体检测作为回归问题进行求解, 整个检测网络pipeline简单. 在titan x GPU上, 在保证检测准确率的前提下(63.4\% mAP, VOC 2007 test set), 可以达到45fps的检测速度.  背景误检率低. YOLO在训练和推理过程中能‘看到’整张图像的整体信息, 而基于region proposal的物体检测方法(如rcnn/fast rcnn), 在检测过程中, 只‘看到’候选框内的局部图像信息. 因此, 若当图像背景(非物体)中的部分数据被包含在候选框中送入检测网络进行检测时, 容易被误检测成物体. 测试证明, YOLO对于背景图像的误检率低于fast rcnn误检率的一半.  通用性强. YOLO对于艺术类作品中的物体检测同样适用. 它对非自然图像物体的检测率远远高于DPM和RCNN系列检测方法. 
  - 缺点: 识别物体位置精准性差. 召回率低.

* 输出层: 输入图像分成SxS个格子, 每个格子负责检测‘落入’该格子的物体. 每个格子输出B个bounding box(包含物体的矩形区域)信息, 以及C个物体属于某种类别的概率信息. Bounding box信息包含5个数据值, 分别是x,y,w,h,和confidence. 其中x,y是指当前格子预测得到的物体的bounding box的中心位置的坐标. w,h是bounding box的宽度和高度. confidence反映当前bounding box是否包含物体以及物体位置的准确性. YOLO网络最终的全连接层的输出维度是 S*S*(B*5 + C)
	作者训练采用的输入图像分辨率是448x448, S=7, B=2; 采用VOC 20类标注物体作为训练数据, C=20. 因此输出向量为7*7*(20 + 2*5)=1470维. 
	虽然每个格子可以预测B个bounding box, 但是最终只选择只选择IOU最高的bounding box作为物体检测输出, 即每个格子最多只预测出一个物体. 当物体占画面比例较小, 如图像中包含畜群或鸟群时, 每个格子包含多个物体, 但却只能检测出其中一个. 这是YOLO方法的一个缺陷. 
* 损失函数: 均方和误差作为loss函数来优化模型参数. 位置相关误差(坐标、IOU)与分类误差对网络loss的贡献值是不同的, 因此YOLO在计算loss时, .
	在计算IOU误差时, 包含物体的格子与不包含物体的格子, 二者的IOU误差对网络loss的贡献值是不同的. 若采用相同的权值, 那么不包含物体的格子的confidence值近似为0, 变相放大了包含物体的格子的confidence误差在计算网络参数梯度时的影响. 为解决这个问题, YOLO 使用
	对于相等的误差值, 大物体误差对检测的影响应小于小物体误差对检测的影响. 这是因为, 相同的位置偏差占大物体的比例远小于同等偏差占小物体的比例. YOLO将物体大小的信息项(w和h)进行求平方根来改进这个问题. 
	YOLO方法模型训练依赖于物体识别标注数据, 因此, 对于非常规的物体形状或比例, YOLO的检测效果并不理想. YOLO采用了多个下采样层, 网络学到的物体特征并不精细, 因此也会影响检测效果. 

## 评价指标

- **准确度（Accuracy）**: 表示模型正确分类的样本与总样本数的比例。
- **精确率（Precision）**: 表示被预测为正类中实际为正类的比例，即真正例的数量除以真正例和假正例之和。
- **召回率（Recall）**: 表示所有正类样本中，被模型正确识别出的比例。
- **AP（Average Precision）**: 用于衡量目标检测算法在单个类别上的性能，通常在多个召回率下的精确率的平均值。
- **mAP（mean Average Precision）**: 当涉及多个类别时，AP的平均值，常用于比较目标检测算法的整体性能。
- **IoU** (Intersection over Unio): 定义了两个bounding box的重叠度

$$
\text{IOU} = \frac{A \cap B}{A \cup B}
$$

<img src="assets/v2-6fe13f10a9cb286f06aa1e3e2a2b29bc_720w.webp" alt="img" style="zoom: 50%;" />